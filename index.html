<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>This Day in History</title>

  <style>
    :root{
      /* Rainbow Markets palette */
      --bg1: #0b1020;
      --bg2: #111b3a;
      --text: #ffffff;
      --muted: rgba(255,255,255,0.78);

      --r-red:    #E10600;
      --r-orange: #ff9500;
      --r-yellow: #ffd60a;
      --r-green:  #009639;
      --r-blue:   #0033a0;
      --r-purple: #af52de;

      --card: rgba(255,255,255,0.07);
      --cardBorder: rgba(255,255,255,0.14);
      --shadow: rgba(0,0,0,0.35);
    }

    html, body { height: 100%; }

    body{
      margin: 0;
      min-height: 100%;
      font-family: Arial, Helvetica, sans-serif;
      color: var(--text);
      background:
        radial-gradient(1200px 600px at 20% 0%, rgba(175,82,222,0.18), transparent 60%),
        radial-gradient(1000px 500px at 85% 20%, rgba(0,122,255,0.18), transparent 60%),
        radial-gradient(900px 500px at 30% 90%, rgba(52,199,89,0.14), transparent 60%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .wrap{
      width: 92vw;
      max-width: 1500px;
      padding: 3.5vw;
    }

    .brandbar{
      height: 10px;
      border-radius: 999px;
      background: linear-gradient(90deg,
        var(--r-red),
      !  var(--r-orange),
      !  var(--r-yellow),
        var(--r-green),
        var(--r-blue),
      !  var(--r-purple)
      );
      box-shadow: 0 10px 22px var(--shadow);
      margin-bottom: 22px;
    }

    .header{
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 18px;
      gap: 20px;
    }

    .title{
      font-size: clamp(36px, 4vw, 64px);
      font-weight: 800;
      letter-spacing: 0.2px;
    }

    .date{
      font-size: clamp(18px, 2vw, 28px);
      color: var(--muted);
      white-space: nowrap;
    }

    .card{
      background: var(--card);
      border: 1px solid var(--cardBorder);
      border-radius: 26px;
      padding: 30px 34px;
      box-shadow: 0 18px 44px var(--shadow);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      min-height: 280px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .badge{
      display: inline-flex;
      align-items: center;
      padding: 8px 16px;
      border-radius: 999px;
      font-weight: 800;
      font-size: clamp(14px, 1.2vw, 18px);
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.08);
      width: fit-content;
      margin-bottom: 14px;
    }

    .badge.event  { box-shadow: 0 0 0 2px rgba(0,122,255,0.25) inset; }
    .badge.birth  { box-shadow: 0 0 0 2px rgba(52,199,89,0.25) inset; }
    .badge.death  { box-shadow: 0 0 0 2px rgba(255,149,0,0.25) inset; }

    .year{
      color: var(--r-yellow);
      font-weight: 900;
      font-size: clamp(34px, 4vw, 72px);
      line-height: 1;
      margin-bottom: 12px;
    }

    .text{
      font-size: clamp(22px, 2.35vw, 42px);
      line-height: 1.2;
      letter-spacing: 0.1px;
    }

    .kicker{
      margin-top: 16px;
      color: var(--muted);
      font-size: clamp(16px, 1.6vw, 22px);
    }

    .footer{
      margin-top: 16px;
      display: flex;
      justify-content: space-between;
      color: var(--muted);
      font-size: clamp(14px, 1.3vw, 20px);
    }

    .pill{
      padding: 6px 14px;
      border-radius: 999px;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.10);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="brandbar"></div>

    <div class="header">
      <div class="title">ðŸ“… This Day in History</div>
      <div class="date" id="dateText"></div>
    </div>

    <div class="card">
      <div class="badge event" id="typeBadge">ðŸ“Œ Event</div>
      <div class="year" id="year">â€¦</div>
      <div class="text" id="desc">Loading todayâ€™s historyâ€¦</div>
      <div class="kicker">Rainbow Markets â€¢ Fresh daily</div>
    </div>

    <div class="footer">
      <div class="pill" id="counter">Item 0 of 0</div>
      <div class="pill">Source: DayInHistory.dev</div>
    </div>
  </div>

  <script>
    const dateText   = document.getElementById("dateText");
    const yearEl     = document.getElementById("year");
    const descEl     = document.getElementById("desc");
    const counterEl  = document.getElementById("counter");
    const typeBadge  = document.getElementById("typeBadge");

    const now = new Date();
    dateText.textContent = now.toLocaleDateString(undefined, {
      weekday: "long",
      year: "numeric",
      month: "long",
      day: "numeric"
    });

    let items = [];
    let idx = 0;

    function render() {
      if (!items.length) return;
      const it = items[idx];

      yearEl.textContent = it.year || "â€”";
      descEl.textContent = it.text || "â€”";
      counterEl.textContent = `Item ${idx + 1} of ${items.length}`;

      const t = (it.type || "Event").toLowerCase();
      if (t.includes("birth")) {
        typeBadge.className = "badge birth";
        typeBadge.textContent = "ðŸŽ‚ Birth";
      } else if (t.includes("death")) {
        typeBadge.className = "badge death";
        typeBadge.textContent = "ðŸ•¯ï¸ Death";
      } else {
        typeBadge.className = "badge event";
        typeBadge.textContent = "ðŸ“Œ Event";
      }
    }

    async function load() {
      try {
        const res = await fetch("/data/today.json", { cache: "no-store" });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);

        const data = await res.json();
        items = (data.items || []).slice(0, 30);

        if (!items.length) throw new Error("No items found");

        idx = Math.floor(Math.random() * items.length);
        render();

        setInterval(() => {
          idx = (idx + 1) % items.length;
          render();
        }, 10000);

      } catch (err) {
        yearEl.textContent = "Oops";
        descEl.textContent = "Couldnâ€™t load todayâ€™s history.";
        counterEl.textContent = "Item 0 of 0";
        console.error(err);
      }
    }

    load();
  </script>
</body>
</html>
